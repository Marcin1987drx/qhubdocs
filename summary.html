<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Inspection Summary</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      margin: 40px;
      color: #333;
    }
    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 30px;
    }
    h1 {
      color: #0078d4;
      margin-bottom: 10px;
    }
    .section {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 24px;
      margin-bottom: 30px;
    }
    .section b {
      color: #0078d4;
    }
    .alert {
      border: 2px dashed red;
      padding: 15px;
      background-color: #ffe6e6;
      color: darkred;
      font-weight: bold;
      margin-top: 20px;
    }
    footer {
      margin-top: 40px;
      font-size: 0.9em;
      color: gray;
    }
    #qr {
      margin: 20px 0;
    }
  </style>
</head>
<body> <header>
    <img src="https://raw.githubusercontent.com/marcin1987drx/qhubdocs/main/assets/qhub-logo.png" alt="QualityHub Logo" height="40">
    <img src="https://raw.githubusercontent.com/marcin1987drx/qhubdocs/main/assets/draex-logo.png" alt="DRÄXLMAIER Logo" height="40">
  </header> <h1>Inspection Summary</h1> <div id="errorAlert" class="alert" style="display: none">
    🚨 Wykryto niezgodności! Cześć trafi do Verschrott!
  </div> <div class="section">
    <div>
      <b>📦 General Info</b><br>
      <div id="sap"></div>
      <div id="rev"></div>
      <div id="part"></div>
      <div id="supplier"></div>
      <div id="delnote"></div>
      <div id="orderno"></div>
      <div id="deldate"></div>
      <br>
      <b>📊 Quantity Overview</b><br>
      <div id="insdate"></div>
      <div id="qty"></div>
      <div id="ok"></div>
      <div id="nok"></div>
      <div id="reworked"></div>
    </div>
    <div>
      <b>❌ Defects Summary</b><br>
      <div id="defects"></div>
    </div>
  </div><b>📜 Comments</b><br>

  <div id="comments"></div><br><b>📌 Attachments</b><br> <small>Pliki załączone poniżej 👇</small><br>

  <div id="qr"></div> <footer>
    Generated by QualityHub | <span id="printTime"></span>
  </footer> <script>
    const params = new URLSearchParams(window.location.search);

    const mapField = (id, label, value) => {
      if (value) document.getElementById(id).innerHTML = `<b>${label}:</b> ${value}<br>`;
    };

    mapField("sap", "SAP Number", params.get("sapnumber"));
    mapField("rev", "Revision", params.get("revision"));
    mapField("part", "Part Number", params.get("partnumber"));
    mapField("supplier", "Supplier", params.get("supplier"));
    mapField("delnote", "Delivery Note", params.get("deliverynote"));
    mapField("orderno", "Order Number", params.get("ordernumber"));
    mapField("deldate", "Delivery Date", params.get("deliverydate"));
    mapField("insdate", "Inspection Date", params.get("inspectiondate"));
    mapField("qty", "Total Qty", params.get("totalqty"));
    mapField("ok", "i.O.", params.get("okqty"));
    mapField("nok", "n.i.O.", params.get("nokqty"));
    mapField("reworked", "Reworked", params.get("reworkedqty"));
    mapField("comments", "QS Comment", params.get("comments"));

    // Defects list
    const defects = document.getElementById("defects");
    for (let i = 1; i <= 3; i++) {
      const def = params.get(`defect${i}`);
      const ras = params.get(`raster${i}`);
      const nok = params.get(`nok${i}`);
      const rew = params.get(`reworked${i}`);
      if (def || ras || nok || rew) {
        defects.innerHTML += `<b>Defect ${i}:</b> ${def || "-"}<br>`;
        defects.innerHTML += `<b>Raster ${i}:</b> ${ras || "-"}<br>`;
        defects.innerHTML += `<b>NOK ${i}:</b> ${nok || "0"}<br>`;
        defects.innerHTML += `<b>Reworked ${i}:</b> ${rew || "0"}<br><br>`;
      }
    }

    // QR Code
    const qrContent = window.location.href;
    const qrUrl = `https://api.qrserver.com/v1/create-qr-code/?size=100x100&data=${encodeURIComponent(qrContent)}`;
    document.getElementById("qr").innerHTML = `<img src='${qrUrl}' alt='QR Code'>`;

    // Alert for NOK > 0
    if (parseInt(params.get("nokqty")) > 0) {
      document.getElementById("errorAlert").style.display = "block";
    }

    // Footer timestamp
    document.getElementById("printTime").innerText = `Printed: ${new Date().toLocaleString()}`;
  </script></body>
</html>
